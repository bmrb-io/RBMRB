---
title: "RBMRB"
author: "Kumaran Baskaran"
date: "July 29, 2016"
output: word_document
---

#RBMRB

RBMRB is a library to fetch chemical shift data directly from [BMRB](http://bmrb.wisc.edu/) into R environment 
as a data frame in R. This facilitates access to BMRB data for statistical analysis and data visualization. It is using the [BMRB-API](https://github.com/uwbmrb/BMRB-API) in the back end to fetch the data from BMRB database. 

##Installation

### Requirements

RBMRB library is  developed and tested in  R version 3.3. It requires the following R packages


 **data.table** to import data from BMRB web server
 **httr** to format the imported data into a data frame in R. 
 **rjson** to deal with BMRB-API
 **ggplot2** to simulate spectra
 **plotly** for interactive graphics in simulated spectra
 
 Users should ensure the proper installtion of above packages, before proceeding to RMBRM insallation.

Here is the instruction to install those packages. Open your R and use the following command 


Once the necessary packages has been installed, the source file can be downloaded from GitHub.
Source package can be downloaded from this [link](https://github.com/uwbmrb/RBMRB/raw/master/RBMRB_1.0.tar.gz)

After downloading use the following command to install RBMRB
```{r eval=F}
install.packages("~/Downloads/RBMRB_1.0.tar.gz",repos=NULL,type="source")
```

Note: provide the correct path to the downloaded file.

##Usage
RBMRB can be used in a similar way like any other library in R. 

```{r}
library(RBMRB)
```

To fetch chemical shift table of a specific entry
```{r}
df<-fetch_entry_chemical_shifts(15060)
```
Imported data frame contains following columns
```{r}
colnames(df)
```

Its also possible to load multiple entries as a single data frame
```{r}
df<-fetch_entry_chemical_shifts(c(17074,17076,17077))
```

These data frames can be reformatted using the function **convert_cs_to_n15hsqc** to simulate HSQC spectrum from the data frame.
```{r}
hsqc<-convert_cs_to_n15hsqc(df)
```
Now user can use his own plotting function to visualize HSQC spectrum
for example
```{r}
library(ggplot2)
ggplot(hsqc)+
  geom_point(aes(H,N,color=as.character(Entry_ID)))+
  scale_x_reverse()+scale_y_reverse()+theme(legend.title=element_blank())
```

The entire chemical shift for a given atom can be downloaded usign the following command
```{r}
df_cb2<-fetch_atom_chemical_shifts('CB2')
```

Once it is downloaded, then you have full chemical shift list of a given atom from  all entries from the macromolecules databse. 
```{r}
colnames(df_cb2)
```

Similarly chemical shift list from metabolites database can also be fetched usign the same command

```{r}
df_c1<-fetch_atom_chemical_shifts('C1',db="metabolomics")
```

#Data Visualization
RBMRB library has a function to simulate 1H-15N HSQC spectrum directly from BMRB database.


## HSQC Spectra
```{r}
spec1<-simulate_n15hsqc(c(17074,17076,17077))
spec1
```

```{r}
spec2<-simulate_n15hsqc(c(17074,17076,17077),type='line')
spec2
```

An interactive plot can also be created if the package **plotly** has been installed properly.

```{r}
spec3<-simulate_n15hsqc(c(17074,17076,17077),type='line',interactive = T)
spec3
```

Tool tip will show the dtails about the peak when you mouse over and can also be zoomed using mouse. 
